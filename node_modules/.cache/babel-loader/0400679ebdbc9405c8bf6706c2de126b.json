{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lucas\\\\Desktop\\\\projetos-react\\\\linkr\\\\src\\\\components\\\\UserPage\\\\UserPage.js\",\n    _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { useParams } from \"react-router\";\nimport UserContext from \"../../contexts/UserContexts\";\nimport Loading from \"../Loading/Loading\";\nimport StyledTimeline from \"../Styles/StyledTimeline\";\nimport PostsList from \"../Timeline/PostsList\";\nimport styled from \"styled-components\";\nimport useInterval from \"../useInterval/useInterval\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function UserPage() {\n  _s();\n\n  const [posts, setPosts] = useState();\n  const [isLoading, setIsLoading] = useState(true);\n  const [hasMore, setHasMore] = useState(true);\n  const [error, setError] = useState(false);\n  const [userInfo, setUserInfo] = useState(null);\n  const {\n    user\n  } = useContext(UserContext);\n  const {\n    userId\n  } = useParams();\n  const [displayButton, setDisplayButton] = useState(true);\n  const [following, setFollowing] = useState(false);\n  const [loadingFollow, setLoadingFollow] = useState(false);\n  useEffect(() => {\n    if (user) {\n      if (user.id === Number(userId)) {\n        setDisplayButton(false);\n      }\n\n      setIsLoading(true);\n      setUserInfo(\"\");\n      setPosts();\n      getInfo();\n      getPosts();\n      getFollows();\n    }\n  }, [user]);\n  useEffect(() => {\n    if (user) {\n      setIsLoading(true);\n      getInfo();\n      getFollows();\n      getPosts(true, true);\n      window.scrollTo({\n        top: 0,\n        behavior: \"smooth\"\n      });\n    }\n  }, [userId]);\n\n  function getPosts(earlier, reset) {\n    const config = {\n      headers: {\n        Authorization: `Bearer ${user.token}`\n      }\n    };\n    let url = `https://mock-api.bootcamp.respondeai.com.br/api/v2/linkr/users/${userId}/posts`;\n    let referenceId;\n\n    if (!reset) {\n      if (earlier) {\n        if (posts) {\n          referenceId = posts[0].repostId ? posts[0].repostId : posts[0].id;\n          url = `${url}?earlierThan=${referenceId}`;\n        }\n      } else {\n        if (posts && posts.length > 0) {\n          referenceId = posts[posts.length - 1].repostId ? posts[posts.length - 1].repostId : posts[posts.length - 1].id;\n          url = `${url}?olderThan=${referenceId}`;\n        }\n      }\n    }\n\n    const request = axios.get(url, config);\n    let refreshPosts;\n    request.then(response => {\n      if (earlier && !reset) {\n        if (posts) {\n          refreshPosts = [...response.data.posts, ...posts];\n        } else {\n          refreshPosts = [...response.data.posts];\n        }\n      } else {\n        if (reset) {\n          refreshPosts = [...response.data.posts];\n        } else {\n          refreshPosts = posts ? [...posts, ...response.data.posts] : [...response.data.posts];\n        }\n\n        if (response.data.posts.length < 10) {\n          setHasMore(false);\n        }\n      }\n\n      setPosts(refreshPosts);\n      setIsLoading(false);\n    });\n    request.catch(() => {\n      setHasMore(false);\n      setIsLoading(false);\n      setError(true);\n    });\n  }\n\n  useInterval(() => {\n    if (hasMore) {\n      getPosts(true);\n    }\n  }, 15000);\n\n  function getInfo() {\n    const config = {\n      headers: {\n        Authorization: `Bearer ${user.token}`\n      }\n    };\n    const request = axios.get(`https://mock-api.bootcamp.respondeai.com.br/api/v2/linkr/users/${userId}`, config);\n    request.then(response => {\n      setUserInfo(response.data.user);\n    });\n    request.catch(error => {\n      alert(error.response.data.message);\n    });\n  }\n\n  function getFollows() {\n    const config = {\n      headers: {\n        Authorization: `Bearer ${user.token}`\n      }\n    };\n    const request = axios.get(`https://mock-api.bootcamp.respondeai.com.br/api/v2/linkr/users/follows`, config);\n    request.then(response => {\n      const userFollows = response.data.users.filter(item => item.id === Number(userId));\n\n      if (userFollows.length > 0) {\n        setFollowing(true);\n      } else {\n        setFollowing(false);\n      }\n    });\n    request.catch(error => {\n      alert(error.response.data.message);\n    });\n  }\n\n  function follow() {\n    setLoadingFollow(true);\n    const config = {\n      headers: {\n        Authorization: `Bearer ${user.token}`\n      }\n    };\n    const request = axios.post(`https://mock-api.bootcamp.respondeai.com.br/api/v2/linkr/users/${userId}/follow`, {}, config);\n    request.then(() => {\n      setFollowing(true);\n      setLoadingFollow(false);\n    });\n    request.catch(error => {\n      setLoadingFollow(false);\n      alert(`Operation not possible due to ${error.response.data.message}.`);\n    });\n  }\n\n  function unfollow() {\n    setLoadingFollow(true);\n    const config = {\n      headers: {\n        Authorization: `Bearer ${user.token}`\n      }\n    };\n    const request = axios.post(`https://mock-api.bootcamp.respondeai.com.br/api/v2/linkr/users/${userId}/unfollow`, {}, config);\n    request.then(() => {\n      setFollowing(false);\n      setLoadingFollow(false);\n    });\n    request.catch(error => {\n      alert(`Operation not possible due to ${error.response.data.message}.`);\n      setLoadingFollow(false);\n    });\n  }\n\n  function removePost(repost, id) {\n    let filteredPosts = [];\n\n    if (repost) {\n      filteredPosts = posts.filter(p => p.repostId !== id);\n    } else {\n      filteredPosts = posts.filter(p => p.id !== id);\n    }\n\n    const refreshPosts = [...filteredPosts];\n    setPosts(refreshPosts);\n  }\n\n  return /*#__PURE__*/_jsxDEV(StyledTimeline, {\n    children: [/*#__PURE__*/_jsxDEV(Introduction, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Avatar, {\n          url: userInfo && userInfo.avatar\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this), userInfo && /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: [userInfo.username, \"'s posts\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 24\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FollowButton, {\n        onClick: following ? unfollow : follow,\n        followinguser: following,\n        show: displayButton,\n        disabled: loadingFollow,\n        children: following ? \"Unfollow\" : \"Follow\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"page-left\",\n        children: isLoading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 13\n        }, this) : posts === null || posts === undefined ? error ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"warning\",\n          children: \"Could not get posts right now. Please try again.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 15\n        }, this) : \"\" : posts.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"warning\",\n          children: \"This person has not posted yet!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(PostsList, {\n          posts: posts,\n          getPosts: getPosts,\n          hasMore: hasMore,\n          removePost: removePost\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"page-right\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 206,\n    columnNumber: 5\n  }, this);\n}\n\n_s(UserPage, \"cS1PGU9E37cJpBafj2nLZErIjdA=\", false, function () {\n  return [useParams, useInterval];\n});\n\n_c = UserPage;\nconst Introduction = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 44px;\n\n  > div {\n    display: flex;\n    width: 100%;\n    align-items: center;\n    padding-left: 20px;\n    overflow-wrap: break-word;\n    word-wrap: break-word;\n  }\n  > div div {\n    margin-right: 18px;\n    flex-shrink: 0;\n  }\n\n  h1 {\n    margin: 0;\n    overflow-wrap: break-word;\n    word-wrap: break-word;\n    word-break: break-word;\n  }\n  @media (max-width: 740px) {\n    margin-left: 10px;\n\n    > div {\n      padding-left: 0px;\n    }\n    > div div {\n      margin-right: 0;\n      flex-shrink: 0;\n    }\n    h1 {\n      padding-right: 5px;\n    }\n    button {\n      margin-right: 10px;\n    }\n  }\n  @media (max-width: 600px) {\n    flex-direction: column;\n    margin-bottom: 10px;\n  }\n`;\n_c2 = Introduction;\nconst FollowButton = styled.button`\n  display: ${props => props.show ? \"block\" : \"none\"};\n  width: 112px;\n  height: 31px;\n  background: ${props => props.followinguser ? \"white\" : \"#1877F2\"};\n  border-radius: 5px;\n  border: none;\n  font-weight: bold;\n  font-size: 14px;\n  line-height: 17px;\n  color: ${props => props.followinguser ? \"#1877F2\" : \"white\"};\n  font-family: Lato;\n  flex-shrink: 0;\n  cursor: pointer;\n\n  :disabled {\n    filter: brightness(0.7);\n  }\n`;\n_c3 = FollowButton;\nconst Avatar = styled.div`\n  background-image: url(${props => props.url});\n  width: 50px;\n  height: 50px;\n  border-radius: 26.5px;\n  background-size: cover;\n  background-position: center;\n  top: 0;\n  right: 0;\n`;\n_c4 = Avatar;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"UserPage\");\n$RefreshReg$(_c2, \"Introduction\");\n$RefreshReg$(_c3, \"FollowButton\");\n$RefreshReg$(_c4, \"Avatar\");","map":{"version":3,"sources":["C:/Users/lucas/Desktop/projetos-react/linkr/src/components/UserPage/UserPage.js"],"names":["axios","useContext","useEffect","useState","useParams","UserContext","Loading","StyledTimeline","PostsList","styled","useInterval","UserPage","posts","setPosts","isLoading","setIsLoading","hasMore","setHasMore","error","setError","userInfo","setUserInfo","user","userId","displayButton","setDisplayButton","following","setFollowing","loadingFollow","setLoadingFollow","id","Number","getInfo","getPosts","getFollows","window","scrollTo","top","behavior","earlier","reset","config","headers","Authorization","token","url","referenceId","repostId","length","request","get","refreshPosts","then","response","data","catch","alert","message","userFollows","users","filter","item","follow","post","unfollow","removePost","repost","filteredPosts","p","avatar","username","undefined","Introduction","div","FollowButton","button","props","show","followinguser","Avatar"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { useContext, useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router\";\r\nimport UserContext from \"../../contexts/UserContexts\";\r\n\r\nimport Loading from \"../Loading/Loading\";\r\nimport StyledTimeline from \"../Styles/StyledTimeline\";\r\nimport PostsList from \"../Timeline/PostsList\";\r\n\r\nimport styled from \"styled-components\";\r\nimport useInterval from \"../useInterval/useInterval\";\r\n\r\nexport default function UserPage() {\r\n  const [posts, setPosts] = useState();\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [error, setError] = useState(false);\r\n  const [userInfo, setUserInfo] = useState(null);\r\n  const { user } = useContext(UserContext);\r\n  const { userId } = useParams();\r\n\r\n  const [displayButton, setDisplayButton] = useState(true);\r\n  const [following, setFollowing] = useState(false);\r\n  const [loadingFollow, setLoadingFollow] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      if (user.id === Number(userId)) {\r\n        setDisplayButton(false);\r\n      }\r\n      setIsLoading(true);\r\n      setUserInfo(\"\");\r\n      setPosts();\r\n      getInfo();\r\n      getPosts();\r\n      getFollows();\r\n    }\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      setIsLoading(true);\r\n      getInfo();\r\n      getFollows();\r\n      getPosts(true, true);\r\n      window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n    }\r\n  }, [userId]);\r\n\r\n  function getPosts(earlier, reset) {\r\n    const config = {\r\n      headers: {\r\n        Authorization: `Bearer ${user.token}`,\r\n      },\r\n    };\r\n    let url = `https://mock-api.bootcamp.respondeai.com.br/api/v2/linkr/users/${userId}/posts`;\r\n    let referenceId;\r\n    if (!reset) {\r\n      if (earlier) {\r\n        if (posts) {\r\n          referenceId = posts[0].repostId ? posts[0].repostId : posts[0].id;\r\n          url = `${url}?earlierThan=${referenceId}`;\r\n        }\r\n      } else {\r\n        if (posts && posts.length > 0) {\r\n          referenceId = posts[posts.length - 1].repostId\r\n            ? posts[posts.length - 1].repostId\r\n            : posts[posts.length - 1].id;\r\n          url = `${url}?olderThan=${referenceId}`;\r\n        }\r\n      }\r\n    }\r\n    const request = axios.get(url, config);\r\n    let refreshPosts;\r\n    request.then((response) => {\r\n      if (earlier && !reset) {\r\n        if (posts) {\r\n          refreshPosts = [...response.data.posts, ...posts];\r\n        } else {\r\n          refreshPosts = [...response.data.posts];\r\n        }\r\n      } else {\r\n        if (reset) {\r\n          refreshPosts = [...response.data.posts];\r\n        } else {\r\n          refreshPosts = posts\r\n            ? [...posts, ...response.data.posts]\r\n            : [...response.data.posts];\r\n        }\r\n        if (response.data.posts.length < 10) {\r\n          setHasMore(false);\r\n        }\r\n      }\r\n      setPosts(refreshPosts);\r\n      setIsLoading(false);\r\n    });\r\n\r\n    request.catch(() => {\r\n      setHasMore(false);\r\n      setIsLoading(false);\r\n      setError(true);\r\n    });\r\n  }\r\n\r\n  useInterval(() => {\r\n    if (hasMore) {\r\n      getPosts(true);\r\n    }\r\n  }, 15000);\r\n\r\n  function getInfo() {\r\n    const config = {\r\n      headers: {\r\n        Authorization: `Bearer ${user.token}`,\r\n      },\r\n    };\r\n    const request = axios.get(\r\n      `https://mock-api.bootcamp.respondeai.com.br/api/v2/linkr/users/${userId}`,\r\n      config\r\n    );\r\n    request.then((response) => {\r\n      setUserInfo(response.data.user);\r\n    });\r\n    request.catch((error) => {\r\n      alert(error.response.data.message);\r\n    });\r\n  }\r\n\r\n  function getFollows() {\r\n    const config = {\r\n      headers: {\r\n        Authorization: `Bearer ${user.token}`,\r\n      },\r\n    };\r\n    const request = axios.get(\r\n      `https://mock-api.bootcamp.respondeai.com.br/api/v2/linkr/users/follows`,\r\n      config\r\n    );\r\n    request.then((response) => {\r\n      const userFollows = response.data.users.filter(\r\n        (item) => item.id === Number(userId)\r\n      );\r\n      if (userFollows.length > 0) {\r\n        setFollowing(true);\r\n      } else {\r\n        setFollowing(false);\r\n      }\r\n    });\r\n    request.catch((error) => {\r\n      alert(error.response.data.message);\r\n    });\r\n  }\r\n  function follow() {\r\n    setLoadingFollow(true);\r\n    const config = {\r\n      headers: {\r\n        Authorization: `Bearer ${user.token}`,\r\n      },\r\n    };\r\n    const request = axios.post(\r\n      `https://mock-api.bootcamp.respondeai.com.br/api/v2/linkr/users/${userId}/follow`,\r\n      {},\r\n      config\r\n    );\r\n    request.then(() => {\r\n      setFollowing(true);\r\n      setLoadingFollow(false);\r\n    });\r\n    request.catch((error) => {\r\n      setLoadingFollow(false);\r\n      alert(`Operation not possible due to ${error.response.data.message}.`);\r\n    });\r\n  }\r\n  function unfollow() {\r\n    setLoadingFollow(true);\r\n    const config = {\r\n      headers: {\r\n        Authorization: `Bearer ${user.token}`,\r\n      },\r\n    };\r\n    const request = axios.post(\r\n      `https://mock-api.bootcamp.respondeai.com.br/api/v2/linkr/users/${userId}/unfollow`,\r\n      {},\r\n      config\r\n    );\r\n    request.then(() => {\r\n      setFollowing(false);\r\n      setLoadingFollow(false);\r\n    });\r\n    request.catch((error) => {\r\n      alert(`Operation not possible due to ${error.response.data.message}.`);\r\n      setLoadingFollow(false);\r\n    });\r\n  }\r\n  function removePost(repost, id) {\r\n    let filteredPosts = [];\r\n    if (repost) {\r\n      filteredPosts = posts.filter((p) => p.repostId !== id);\r\n    } else {\r\n      filteredPosts = posts.filter((p) => p.id !== id);\r\n    }\r\n    const refreshPosts = [...filteredPosts];\r\n    setPosts(refreshPosts);\r\n  }\r\n  return (\r\n    <StyledTimeline>\r\n      <Introduction>\r\n        <div>\r\n          <Avatar url={userInfo && userInfo.avatar} />\r\n          {userInfo && <h1>{userInfo.username}'s posts</h1>}\r\n        </div>\r\n        <FollowButton\r\n          onClick={following ? unfollow : follow}\r\n          followinguser={following}\r\n          show={displayButton}\r\n          disabled={loadingFollow}\r\n        >\r\n          {following ? \"Unfollow\" : \"Follow\"}\r\n        </FollowButton>\r\n      </Introduction>\r\n      <div className=\"main-content\">\r\n        <div className=\"page-left\">\r\n          {isLoading ? (\r\n            <Loading />\r\n          ) : posts === null || posts === undefined ? (\r\n            error ? (\r\n              <p className=\"warning\">\r\n                Could not get posts right now. Please try again.\r\n              </p>\r\n            ) : (\r\n              \"\"\r\n            )\r\n          ) : posts.length === 0 ? (\r\n            <p className=\"warning\">This person has not posted yet!</p>\r\n          ) : (\r\n            <PostsList\r\n              posts={posts}\r\n              getPosts={getPosts}\r\n              hasMore={hasMore}\r\n              removePost={removePost}\r\n            />\r\n          )}\r\n        </div>\r\n        <div className=\"page-right\"></div>\r\n      </div>\r\n    </StyledTimeline>\r\n  );\r\n}\r\n\r\nconst Introduction = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 44px;\r\n\r\n  > div {\r\n    display: flex;\r\n    width: 100%;\r\n    align-items: center;\r\n    padding-left: 20px;\r\n    overflow-wrap: break-word;\r\n    word-wrap: break-word;\r\n  }\r\n  > div div {\r\n    margin-right: 18px;\r\n    flex-shrink: 0;\r\n  }\r\n\r\n  h1 {\r\n    margin: 0;\r\n    overflow-wrap: break-word;\r\n    word-wrap: break-word;\r\n    word-break: break-word;\r\n  }\r\n  @media (max-width: 740px) {\r\n    margin-left: 10px;\r\n\r\n    > div {\r\n      padding-left: 0px;\r\n    }\r\n    > div div {\r\n      margin-right: 0;\r\n      flex-shrink: 0;\r\n    }\r\n    h1 {\r\n      padding-right: 5px;\r\n    }\r\n    button {\r\n      margin-right: 10px;\r\n    }\r\n  }\r\n  @media (max-width: 600px) {\r\n    flex-direction: column;\r\n    margin-bottom: 10px;\r\n  }\r\n`;\r\n\r\nconst FollowButton = styled.button`\r\n  display: ${(props) => (props.show ? \"block\" : \"none\")};\r\n  width: 112px;\r\n  height: 31px;\r\n  background: ${(props) => (props.followinguser ? \"white\" : \"#1877F2\")};\r\n  border-radius: 5px;\r\n  border: none;\r\n  font-weight: bold;\r\n  font-size: 14px;\r\n  line-height: 17px;\r\n  color: ${(props) => (props.followinguser ? \"#1877F2\" : \"white\")};\r\n  font-family: Lato;\r\n  flex-shrink: 0;\r\n  cursor: pointer;\r\n\r\n  :disabled {\r\n    filter: brightness(0.7);\r\n  }\r\n`;\r\n\r\nconst Avatar = styled.div`\r\n  background-image: url(${(props) => props.url});\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 26.5px;\r\n  background-size: cover;\r\n  background-position: center;\r\n  top: 0;\r\n  right: 0;\r\n`;\r\n"]},"metadata":{},"sourceType":"module"}